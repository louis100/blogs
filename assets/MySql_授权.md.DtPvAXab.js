import{_ as i,c as a,o as t,ag as n}from"./chunks/framework.C4SRkA9c.js";const g=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"MySql/授权.md","filePath":"MySql/授权.md","lastUpdated":1761188845000}'),e={name:"MySql/授权.md"};function l(h,s,p,r,k,o){return t(),a("div",null,[...s[0]||(s[0]=[n(`<p>以下是针对Windows服务器通过命令行解决MySQL连接报错**&quot;Host is not allowed to connect to this MySQL server&quot;**的完整步骤：</p><hr><h3 id="一、检查并修改用户权限" tabindex="-1">一、<strong>检查并修改用户权限</strong> <a class="header-anchor" href="#一、检查并修改用户权限" aria-label="Permalink to &quot;一、**检查并修改用户权限**&quot;">​</a></h3><ol><li><p><strong>登录MySQL服务器</strong><br> 以管理员身份运行CMD或PowerShell，执行：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mysql</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span></span></code></pre></div><p>输入密码后进入MySQL命令行。</p></li><li><p><strong>授权远程访问</strong> 【8.0 前】</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 切换到mysql系统数据库</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">USE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mysql;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 允许root用户从任意IP访问（生产环境建议限制为特定IP）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">UPDATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> user </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> host</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;%&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;root&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 或创建专用用户并授权（更安全）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GRANT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ALL PRIVILEGES </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;remote_user&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;%&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> IDENTIFIED </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;your_password&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 刷新权限</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">FLUSH PRIVILEGES;</span></span></code></pre></div><p>其中<code>%</code>表示允许所有IP，可替换为<code>192.168.1.%</code>等特定IP段。</p></li><li><p><strong>8.0 后版本</strong></p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 先创建用户</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> USER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dev</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&#39;@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;host&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> IDENTIFIED </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;a@fh1g@hj5h9&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 再单独授权</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GRANT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ALL PRIVILEGES </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> database</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;dev&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;host&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">FLUSH PRIVILEGES;</span></span></code></pre></div></li></ol><hr><h3 id="二、验证防火墙与端口" tabindex="-1">二、<strong>验证防火墙与端口</strong> <a class="header-anchor" href="#二、验证防火墙与端口" aria-label="Permalink to &quot;二、**验证防火墙与端口**&quot;">​</a></h3><ol><li><p><strong>检查3306端口是否开放</strong><br> 在服务器上执行：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">netstat</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -ano</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> findstr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3306</span></span></code></pre></div><p>若未监听，需检查MySQL服务是否启动。</p></li><li><p><strong>临时关闭防火墙测试</strong></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">netsh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> advfirewall</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> allprofiles</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> state</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> off</span></span></code></pre></div><p>测试后重新启用：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">netsh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> advfirewall</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> allprofiles</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> state</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> on</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`\`\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">。</span></span></code></pre></div></li></ol><hr><h3 id="三、修改mysql配置文件-可选" tabindex="-1">三、<strong>修改MySQL配置文件（可选）</strong> <a class="header-anchor" href="#三、修改mysql配置文件-可选" aria-label="Permalink to &quot;三、**修改MySQL配置文件（可选）**&quot;">​</a></h3><ol><li>编辑<code>my.ini</code>（默认路径<code>C:\\ProgramData\\MySQL\\MySQL Server X.X\\</code>）：<div class="language-ini vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ini</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">[mysqld]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bind-address</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> = 0.0.0.0</span></span></code></pre></div></li><li>重启MySQL服务：<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">net</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stop</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mysql</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">net</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mysql</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`\`\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">。</span></span></code></pre></div></li></ol><hr><h3 id="四、测试远程连接" tabindex="-1">四、<strong>测试远程连接</strong> <a class="header-anchor" href="#四、测试远程连接" aria-label="Permalink to &quot;四、**测试远程连接**&quot;">​</a></h3><p>从客户端执行：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mysql</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> remote_user</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -h</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">服务器I</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">P</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span></span></code></pre></div><p>输入密码验证是否成功。</p><hr><h3 id="五、安全建议" tabindex="-1">五、<strong>安全建议</strong> <a class="header-anchor" href="#五、安全建议" aria-label="Permalink to &quot;五、**安全建议**&quot;">​</a></h3><ol><li><strong>限制访问IP</strong><br> 避免使用<code>%</code>，改为<code>GRANT ... TO &#39;user&#39;@&#39;192.168.1.100&#39;</code>。</li><li><strong>定期审计权限</strong><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> user, host </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">user</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`\`\`。</span></span></code></pre></div></li></ol><p>引用链接： 1.<a href="http://zhuanlan.zhihu.com/p/1901206013471851552" target="_blank" rel="noreferrer">【IT折腾笔记】去掉网络感叹号和“小地球”,局域网自建网站解决Windows 网络连接验证 - 石艺峰</a> 2.<a href="http://zhuanlan.zhihu.com/p/1906620655807497264" target="_blank" rel="noreferrer">MAS:一条命令永久激活Windows和Office+实现原理解读 - felix</a> 3.[“Host ‘xxx‘ is not allowed to connect to this MySQL server“] 不能远程连接数据库的解决方法 - CSDN博客](<a href="https://blog.csdn.net/weixin_61216004/article/details/133254893" target="_blank" rel="noreferrer">https://blog.csdn.net/weixin_61216004/article/details/133254893</a>) 4.<a href="https://blog.csdn.net/jimingzhe/article/details/139993562" target="_blank" rel="noreferrer">Host ‘192.168.1.1‘is not allowed to connect to this MySQL server,MySQL服务无法通过ip远程连接 - CSDN博客</a> 5.<a href="https://www.cnblogs.com/ttkknetroad/p/7616733.html" target="_blank" rel="noreferrer">解决Host &#39;xxx&#39; is not allowed to connect to this MySQL server - 博客园</a> 6.<a href="https://baijiahao.baidu.com/s?id=1823571782547018379&amp;wfr=spider&amp;for=pc" target="_blank" rel="noreferrer">Win11用户必看!Hosts文件异常导致无法上网的终极解决方案 - EXCEL干货君</a> 7.<a href="https://www.cnblogs.com/jesu/p/5650699.html" target="_blank" rel="noreferrer">解决服务器连接错误Host ‘XXX’ is not allowed to connect to this MySQL server - 博客园</a> 8.<a href="https://baijiahao.baidu.com/s?id=1823688035951631950&amp;wfr=spider&amp;for=pc" target="_blank" rel="noreferrer">轻松解决hosts文件异常,让你的电脑重获网络自由 - EXCEL干货君</a> 9.<a href="https://blog.csdn.net/tiansyun/article/details/137260350" target="_blank" rel="noreferrer">远程连接mysql报错“Host xxx is not allowed to connect to this MySQL server“解决办法 - CSDN博客</a> 10.<a href="https://blog.csdn.net/df981011512/article/details/60769137" target="_blank" rel="noreferrer">本地连接服务器的mysql时Host (服务器ip地址) is not allowed to connect to this MySQL server 的解决方法 - CSDN博客</a> 11.<a href="http://zhuanlan.zhihu.com/p/22939354752" target="_blank" rel="noreferrer">爆火DeepSeek本地部署--解决服务器繁忙的问题 - 自动驾驶转型者</a> 12.<a href="https://www.kdun.com/ask/670980.html" target="_blank" rel="noreferrer">windows链接liunx下的mysql 提示 &quot;host is not allowed to conntect to this mysql server &quot; - www.kdun.com</a> 13.<a href="http://zhuanlan.zhihu.com/p/1896122242829640223" target="_blank" rel="noreferrer">告别混乱与重装烦恼,一款Windows 软件管理神器! - 一只会飞的旺旺</a> 14.<a href="https://www.cnblogs.com/cj1698/p/15102629.html" target="_blank" rel="noreferrer">连接错误:Host xxx is not allowed to connect to this MariaDb server - 博客园</a> 15.<a href="http://mbd.baidu.com/newspage/data/dtlandingsuper?nid=dt_4091622495446164944" target="_blank" rel="noreferrer">💻 Win系统OpenSSH错误解决妙招 - 柳湫纪亿</a> 16.<a href="https://www.rjzxw.com/diannao/9463.html" target="_blank" rel="noreferrer">win11电脑hosts文件配置异常无法上网解决方法? - www.rjzxw.com</a> 17.<a href="https://blog.51cto.com/u_16099184/11867548" target="_blank" rel="noreferrer">host不一致 nginx问题 host not allowed_mob6454cc641ffd的技术博客_51CTO博客 - 51CTO博客</a> 18.<a href="https://ask.csdn.net/questions/8396895" target="_blank" rel="noreferrer">MySQL远程登录失败,提示“Host &#39;xxx&#39; is not allowed to connect to this MySQL server”怎么办? - CSDN问答</a> 19.<a href="https://www.php.cn/faq/648256.html" target="_blank" rel="noreferrer">Win10遇到hosts文件配置异常导致无法上网该如何解决 - php中文网</a> 20.<a href="https://jingyan.baidu.com/article/46650658f7bd92f549e5f8f7.html" target="_blank" rel="noreferrer">mysql连接 Host is not allowed to connect to - 百度经验</a></p>`,19)])])}const c=i(e,[["render",l]]);export{g as __pageData,c as default};
